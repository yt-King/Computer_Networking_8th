# 计算机网络：自顶向下方法，第8版

## 复习题和问题解决方案

**版本日期：** 2020年8月

**文档描述：** 这个文档包含了Jim Kurose和Keith Ross的《计算机网络：自顶向下方法》第8版的复习题和问题解决方案。这些解决方案仅提供给教师。请勿复制或分发此文档给他人（即使是其他教师）。请勿在公开可访问的网站上发布任何解决方案。我们很乐意亲自提供此解决方案手册的最新副本给任何需要的人。

**致谢：** 在过去几年中，几位学生和同事帮助我们准备了这个解决方案手册。特别感谢Honggang Zhang, Rakesh Kumar, Prithula Dhungel, Vijay Annapureddy, Yifan Zhou。也感谢所有提出建议和纠正错误的读者。

**版权声明：** 所有材料版权1996-2020由J.F. Kurose和K.W. Ross所有。保留所有权利。

------

## 专业名词缩写翻译

### HFC

​	混合光纤同轴电缆（Hybrid Fiber Coax，简称HFC）是一种结合光纤与[同轴电缆](https://baike.baidu.com/item/同轴电缆/487866?fromModule=lemma_inlink)的宽带接入网，是一种以频分复用技术为基础，综合应用数字传输技术、光纤和同轴电缆技术、射频技术的智能宽带接入网，是有线电视（CATV）和电话网结合的产物。从接入用户的角度看，HFC是经过双向改造的[有线电视网](https://baike.baidu.com/item/有线电视网/3515951?fromModule=lemma_inlink)，但从整体上看，它是以同轴电缆网络为最终接入部分的宽带网络系统。

### ADSL

​	ADSL（非对称数字用户线 Asymmetric Digital Subscriber Line）是一种利用普通电话线提供高速互联网接入的技术，其特点是上行（从用户到网络）和下行（从网络到用户）的传输速率不同，后者速率更高。它通过频分复用技术在电话线中划分出独立的数据和语音信道，使得用户可以一边打电话一边上网，互不干扰

### DSL

​	DSL，即数字用户线路（[Digital Subscriber Line](https://www.google.com/search?newwindow=1&sca_esv=8482df87b229566e&cs=1&sxsrf=AE3TifMdUXoT_QLuEY724UFRD2yGkHpnnw%3A1758528094590&q=Digital+Subscriber+Line&sa=X&ved=2ahUKEwin_orT8-uPAxUeiq8BHV7iIzIQxccNegQIAhAB&mstk=AUtExfBa9fQqzKAcz4LpRo5dsQOAQ7IvZEnUhB29VHQOs2EiLcWQe-BbzfrYto1RmZ6WiUiXtE-f1OlMgDqAQ7ZDtXNek1iOQrMsa3U5VhlXpvPfEDWCSsXumRq08LyLzoJphY96fdb0g7G3PbSd_hFeltkTViUpjm-vBqMUExGFqHkyPNJJxQW0DVX0yqXXu27iFQxMOCSAXnWAGRXtUAa700Qt2E_NYjq9tarylji4Nq4x2I5JfBvhHX8yAcZ2tNpM8YOwNy9IPorkEYD6db10Bbb9&csui=3)），是一种通过现有电话铜线提供高速宽带互联网接入的技术。它利用电话线未使用的频段来传输数据信号，从而实现了在不影响语音服务的情况下，同时进行数据和语音的传输。DSL通过在用户端和局端分别安装调制解调设备，解决了从网络服务商到用户之间的“最后一公里”传输瓶颈问题。﻿

### FTTH

​	FTTH，即 [光纤到户](https://www.google.com/search?newwindow=1&sca_esv=8482df87b229566e&cs=1&sxsrf=AE3TifMsqscPBeJesrpq_HtVrURzkfWsVQ%3A1758528236593&q=光纤到户&sa=X&ved=2ahUKEwiso-OW9OuPAxVnklYBHd3IDEQQxccNegQIAhAB&mstk=AUtExfAhVS8ah2JZbRu-U7w71MBSwtDhoHtqVYwt9UWdJKgLw7HP-vIrGNldSqjd2JAHpG89nukc5h4XyCBF2ggLPY5bwqelyPxH3Yg2xodVI97TmMM5OIJtdjr25peHq2ejpys6MiiyIshwUxpDWvGyeyZcLDiIXpn6yGkaGdhBwuTS4dVMeSKRxU_MDfGOV-K7r68kXKq8C_Cd5FV-oMKEpQt6S5WECWWH9rbghqOlfWU5VFSxannjnPawKnNnBvPb3_RnqmxX1EzdXxPyxtfYX_dC&csui=3)（Fiber To The Home），是一种将光纤直接铺设到用户家庭或企业的宽带数据传输技术。相比于传统的铜缆或同轴电缆，FTTH 具有提供更大带宽、更低延迟、更强抗干扰能力以及更高稳定性的显著优势，是满足现代高速宽带需求、实现未来虚拟现实、物联网和人工智能等应用场景的最佳解决方案。

### ISP & IXP

​	ISP（Internet Service Provider，互联网服务提供商）是为用户提供互联网接入服务的实体，通常是电信公司、宽带运营商或其他提供网络连接的组织。ISP通过物理基础设施（如光纤、DSL、电缆或移动网络）将用户连接到互联网，提供宽带、拨号或移动数据服务。例如，中国电信、中国移动、Comcast等都是ISP。它们负责为家庭、企业或个人提供网络接入，有时还提供附加服务如电子邮件、域名托管或云存储。

​	IXP（Internet Exchange Point，互联网交换点）是互联网基础设施中的一个物理地点，通常是一个数据中心，多个ISP和其他网络（如内容提供商、云服务商）在这里通过交换设备（如路由器或交换机）直接互联。IXP的主要作用是让不同网络之间直接交换流量，减少对上游网络的依赖，从而降低延迟、提高速度并减少成本。例如，中国的CHIX（中国互联网交换中心）或国际上的AMS-IX（阿姆斯特丹互联网交换中心）都是典型的IXP。

## 第1章 复习题

1. 没有区别。在本文中，“host”和“end system”这两个词可以互换使用。端系统包括PC、工作站、Web服务器、邮件服务器、PDA、连接互联网的游戏机等。

2. 来自维基百科：外交协议通常被描述为一套国际礼仪规则。这些确立已久且久经考验的规则使国家和人民更容易共同生活和工作。协议的一部分始终是承认所有在场人员的等级地位。协议规则基于文明原则。

3. 协议的标准很重要，这样人们才能创建能够互操作的网络系统和产品。

4. 如下：
   >- 通过电话线的拨号调制解调器：家庭；
   >- 通过电话线的DSL：家庭或小型办公室；
   >- 电缆到HFC：家庭；
   >- 100 Mbps交换以太网：企业。

5. HFC带宽在用户之间共享。在下游通道上，所有数据包都来自单一来源，即头部。因此，下游通道中没有碰撞。

6. 在大多数美国城市，目前的可能性包括：拨号；DSL；电缆调制解调器；光纤到户。

7. 以太网LAN的传输速率为10 Mbps、100 Mbps、1 Gbps和10 Gbps。

8. 如今，以太网最常用的是通过双绞铜线运行。它也可以通过光纤链路运行。

9. ADSL：下游高达24 Mbps，上游2.5 Mbps，带宽专用；HFC：下游速率高达42.8 Mbps，上游速率高达30.7 Mbps，带宽共享。FTTH：上传2-10 Mbps；下载10-20 Mbps；带宽不共享。

10. 如今有两种流行的无线互联网接入技术：

    >-  WiFi (802.11) 在无线LAN中，无线用户在数十米半径内向/从基站（即无线接入点）发送/接收数据包。基站通常连接到有线互联网，从而将无线用户连接到有线网络。
    >-  3G和4G广域无线接入网络。在这些系统中，数据包通过用于蜂窝电话的相同无线基础设施传输，基站因此由电信提供商管理。这为基站数十公里半径内的用户提供无线接入。

11. 在时间 $t_0$ 发送主机开始传输。在时间 $t_1 = L/R_1$，发送主机完成传输，整个数据包到达路由器（无传播延迟）。因为路由器在时间 $t_1$ 拥有整个数据包，它可以开始向接收主机传输数据包。在时间 $t_2 = t_1 + L/R_2$，路由器完成传输，整个数据包到达接收主机（再次，无传播延迟）。因此，端到端延迟为 $L/R_1 + L/R_2$。

12. 电路交换网络可以在通话期间保证一定量的端到端带宽。今天大多数分组交换网络（包括互联网）无法对带宽做出任何端到端保证。FDM需要复杂的模拟硬件将信号移到适当的频带。

13. 如下：

    >- 可以支持2个用户，因为每个用户需要一半的链路带宽。
    >- 由于每个用户传输时需要1Mbps，如果两个或更少的用户同时传输，则最多需要2Mbps。由于共享链路的可用带宽为2Mbps，在链路之前没有排队延迟。然而，如果三个用户同时传输，所需的带宽为3Mbps，这超过共享链路的可用带宽。在这种情况下，链路之前会有排队延迟。 
    >- 给定用户正在传输的概率 = 0.2 
    >- 所有三个用户同时传输的概率 = $(0.2)^3 = 0.008$。由于队列在所有用户传输时增长，队列增长的时间比例（等于所有三个用户同时传输的概率）为0.008。

14. 如果两个ISP不相互对等，则当它们相互发送流量时，必须通过提供商ISP（中介）发送流量，并为此付费。通过直接相互对等，两个ISP可以减少对提供商ISP的支付。互联网交换点 (IXP)（通常在一个独立的建筑物中，带有自己的交换机）是多个ISP可以连接和/或对等的汇合点。ISP通过向连接到IXP的每个ISP收取相对较小的费用来赚钱，该费用可能取决于发送到或从IXP接收的流量量。

15. Google的私有网络将所有其数据中心（大大小小）连接在一起。Google数据中心之间的流量通过其私有网络而不是公共互联网传输。这些数据中心中的许多位于或靠近较低层ISP。因此，当Google向用户提供内容时，它通常可以绕过较高层ISP。

    > 内容提供商创建这些网络的动机是什么？首先，内容提供商对用户体验有更多控制，因为它只需要使用少数中介ISP。其次，它可以通过减少进入提供商网络的流量来节省资金。第三，如果ISP决定向高盈利内容提供商收取更多费用（在中立性不适用的国家），内容提供商可以避免这些额外支付。

16. 延迟组件包括处理延迟、传输延迟、传播延迟和排队延迟。除排队延迟外，所有这些延迟都是固定的，排队延迟是可变的。

    >**传输延迟**：与数据包大小和带宽有关，反映发送数据到介质上的时间。
    >
    >**传播延迟**：与物理距离和介质传播速度有关，反映信号从一端到另一端的传播时间。

17. a) 1000 km, 1 Mbps, 100 bytes b) 100 km, 1 Mbps, 100 bytes

18. 10msec；d/s；否；否

19. a) 500 kbps b) 64 seconds c) 100kbps；320 seconds

20. 端系统A将大文件分解成块。它向每个块添加头部，从而从文件中生成多个数据包。每个数据包中的头部包括目的地的IP地址（端系统B）。分组交换机使用数据包中的目的地IP地址来确定出链路。询问走哪条路类似于数据包询问在给定数据包目的地地址的情况下，应该转发到哪个出链路。

21. 最大发射速率为500 packets/sec，最大传输速率为350 packets/sec。对应的流量强度为500/350 =1.43 > 1。每个实验最终都会发生丢失；但第一次丢失的时间因发射过程的随机性而从一个实验到下一个实验不同。

22. 五项通用任务是**错误控制、流量控制、分段和重组、多路复用以及连接设置**。是的，这些任务可以在不同层重复。例如，**错误控制通常在多个层提供**。

23. 互联网协议栈中的五层是从上到下：应用层、传输层、网络层、链路层和物理层。主要责任在第1.5.1节概述。

24. 应用层消息：应用要发送的数据并传递到传输层；传输层段：由传输层生成，并用传输层头部封装应用层消息；网络层数据报：用网络层头部封装传输层段；链路层帧：用链路层头部封装网络层数据报。

25. 路由器处理网络、链路和物理层（层1到3）。（这有点白谎，因为现代路由器有时充当防火墙或缓存组件，并处理传输层。）链路层交换机处理链路和物理层（层1到2）。主机处理所有五层。

26. 病毒和蠕虫是两种恶意软件。病毒依附于宿主文件，需用户操作（如打开文件）传播，破坏本地系统；蠕虫独立运行，通过网络漏洞自动快速扩散，常消耗网络资源或导致瘫痪。病毒传播慢、依赖交互，蠕虫传播快、影响广。

27. 创建僵尸网络需要攻击者在某些应用或系统中找到漏洞（例如，利用应用中可能存在的缓冲区溢出漏洞）。找到漏洞后，攻击者需要扫描易受攻击的主机。目标基本上是通过利用该特定漏洞来入侵一系列系统。僵尸网络中的任何系统都可以自动扫描其环境并通过利用漏洞传播。这种僵尸网络的一个重要属性是，僵尸网络的发起人可以远程控制并向僵尸网络中的所有节点发出命令。因此，攻击者可以向所有节点发出命令，这些命令针对单个节点（例如，僵尸网络中的所有节点可能被攻击者命令向目标发送TCP SYN消息，这可能导致目标处的TCP SYN洪水攻击）。

28. Trudy 可以假装是 Bob 对 Alice（反之亦然），并部分或完全修改从 Bob 发送到 Alice 的消息。例如，她可以轻松地将短语“Alice, I owe you 1000”更改为“Alice, I owe you 10,000”。此外，Trudy 甚至可以丢弃 Bob 发送给 Alice 的数据包（反之亦然），即使 Bob 发送给 Alice 的数据包是加密的。

------

## 第1章 问题

### 问题1

这个问题没有单一正确答案。许多协议都可以做到。下面是一个简单的答案：

从ATM机到服务器的消息

| 消息名称                       | 目的                                                   |
| ------------------------------ | ------------------------------------------------------ |
| HELO <userid>xxx</userid>      | 让服务器知道ATM机中有卡<br />ATM卡将用户ID传输到服务器 |
| PASSWD <passwd>xxx</passwd>    | 用户输入PIN，并发送到服务器                            |
| BALANCE                        | 用户请求余额                                           |
| WITHDRAWL <amount>xxx</amount> | 用户请求取款                                           |
| BYE                            | 用户完成                                               |

从服务器到ATM机（显示）的消息

| 消息名称              | 目的                                    |
| --------------------- | --------------------------------------- |
| PASSWD                | 询问用户PIN（密码）                     |
| OK                    | 上次请求的操作（PASSWD, WITHDRAWL）OK   |
| ERR                   | 上次请求的操作（PASSWD, WITHDRAWL）错误 |
| AMOUNT <amt>xxx</amt> | 响应BALANCE请求发送                     |
| BYE                   | 用户完成，在ATM显示欢迎屏幕             |

正确操作：

| 客户端                      |                 | 服务器                     |
| --------------------------- | --------------- | -------------------------- |
| HELO (userid)               | --------------> | (检查是否有效userid)       |
|                             | <-------------  | PASSWD                     |
| PASSWD <passwd>xxx</passwd> | --------------> | (检查密码)                 |
|                             | <-------------  | OK (密码OK)                |
| BALANCE                     | --------------> |                            |
|                             | <-------------  | AMOUNT <amt>xxx</amt>      |
| WITHDRAWL <amt>xxx</amt>    | --------------> | 检查是否有足够的来覆盖取款 |
|                             | <-------------  | OK                         |
| ATM分发                     |                 |                            |
| BYE                         | --------------> |                            |
|                             | <-------------  | BYE                        |

当没有足够钱的情况：

| 客户端                      |                 | 服务器                     |
| --------------------------- | --------------- | -------------------------- |
| HELO (userid)               | --------------> | (检查是否有效userid)       |
|                             | <-------------  | PASSWD                     |
| PASSWD <passwd>xxx</passwd> | --------------> | (检查密码)                 |
|                             | <-------------  | OK (密码OK)                |
| BALANCE                     | --------------> |                            |
|                             | <-------------  | AMOUNT <amt>xxx</amt>      |
| WITHDRAWL <amt>xxx</amt>    | --------------> | 检查是否有足够的来覆盖取款 |
|                             | <-------------  | ERR (资金不足)             |
| 错误消息显示                |                 |                            |
| 没有分发                    |                 |                            |
| BYE                         | --------------> |                            |
|                             | <-------------  | BYE                        |

### 问题2

$$
d_{end-end}=N\frac{L}{R}
$$

在 N/(L/R) 时刻，第一个数据包到达目的地，第二个数据包存储在最后一个路由器中，第三个数据包存储在倒数第二个路由器中，等等。在时间 N/(L/R) + L/R，第二个数据包到达目的地，第三个数据包存储在最后一个路由器中，等等。继续这个逻辑，我们看到在时间 N/(L/R) + (P-1)/(L/R) = (N+P-1)/(L/R) 所有数据包都到达目的地。

### 问题3

>a) 电路交换网络适合该应用，因为该应用涉及具有可预测平滑带宽要求的长时间会话。由于传输速率已知且非突发，可以为每个应用会话预留带宽而无显著浪费。此外，建立和拆除连接的开销成本在典型应用会话的漫长持续时间内摊销。
>
>b) 在最坏情况下，所有应用同时通过一个或多个网络链路传输。然而，由于每个链路具有足够的带宽来处理所有应用数据速率的总和，不会发生拥塞（很少排队）。鉴于如此慷慨的链路容量，网络不需要拥塞控制机制。

### 问题4

<img src="https://vip.123pan.cn/1843437589/ymjew503t0m000d7w32xwbq54vdlpfxaDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

>a) 在左上角交换机和右上角交换机之间可以有4个连接。类似地，我们可以在其他3对相邻交换机之间各有4个连接。因此，这个网络最多可以支持16个连接。
>
>b) 我们可以通过右上角交换机传递4个连接，通过左下角交换机传递另一个4个连接，总共8个连接。
>
>c) 是的。对于A和C之间的连接，我们通过B路由两个连接，通过D路由两个连接。对于B和D之间的连接，我们通过A路由两个连接，通过C路由两个连接。以这种方式，任何链路最多传递4个连接。

### 问题5

收费站相距75 km，汽车以175 km/hr传播。收费站以每12秒一辆车的速率服务汽车。

>a) 有10辆车。第一个收费站服务10辆车需要120秒，或2分钟。每辆车在到达第二个收费站之前有25.7分钟的传播延迟（行驶75 km）。因此，在27.7分钟后，所有汽车在第二个收费站前排队。这个过程在第二个和第三个收费站之间重复。第三个收费站服务10辆车也需要2分钟。因此总延迟为57.4分钟。
>
>b) 收费站之间的延迟为8*12秒加上25.7分钟。总延迟是这个量的两倍加上8*12秒，即53分钟。

### 问题6

>a) $d_{prop} = m / s$ 秒。
>
>b) $d_{trans} = L / R$ 秒。
>
>c) $d_{end-to-end} = (m/s + L/R)$ 秒。
>
>d) 该位刚刚离开主机A。
>
>e) 传播时延大于传输时延，$t=d_{trans}$时刻第一个位在链路中，还没有到达主机B。
>
>f) 传输时延大于传播时延，$t=d_{prop}$时刻第一个位已经到达主机B。
>
>g)  $m = \frac{L}{R} \times s = \frac{1500 \times 8}{10 \times 10^6 }\times (2.5 \times 10^8) = 3 \times 10^5 = 300 km$。

### 问题7

考虑数据包中的第一个位。在传输这个位之前，必须生成数据包中的所有位。这需要 $\frac{56 \times 8}{64 \times 10^3} 秒 = 7 msec$。

传输数据包所需的时间为 $\frac{56 \times 8}{2 \times 10^6} 秒 = 224 μsec$。

传播延迟 = 10 msec。

所有位都完成传输的延迟为 $7m + 224μ + 10m = 17.224m 秒$。

### 问题8

>a) $3Mbps/150kbps = 20$
>
>b) 10%
>
>c)在分组交换中，有 120 个用户，每个用户独立地以概率 p=0.1 传输。我们需要计算在任意给定时刻，恰好有 n 个用户同时传输的概率。这是一个二项式分布问题。
>
>二项式分布公式为：$P(X=n)= \binom{N}{n} p^n (1-p)^{N-n}$ 其中：
>
>- N=120 N = 120 N=120（总用户数）
>
>- p=0.1 p = 0.1 p=0.1（每个用户传输的概率）
>
>- 1−p=0.9 1-p = 0.9 1−p=0.9（每个用户不传输的概率）
>
>- n n n 是同时传输的用户数
>
>- $\binom{N}{n} = \frac{N!}{n!(N-n)!}$ 是二项式系数
>
>因此，恰好有 n 个用户同时传输的概率为：
>
>$P(X = n) = \binom{120}{n} (0.1)^n (0.9)^{120-n}$
>
>d)$$P(X >=21 ) = \sum_{n=21}^{120} P(X=n) =\sum_{n=21}^{120} \binom{120}{n} (0.1)^n (0.9)^{120-n}$$

### 问题9

>a) 10,000
>
>b) $\sum_{n=1}^{10,000} \binom{10,000}{n} (0.01)^n (0.99)^{10,000-n}$

### 问题10

第一个端系统需要 $L/R_1$ 将数据包传输到第一个链路；数据包在第一个链路上以 $d_1/s_1$ 传播；数据包交换机添加处理延迟 $d_{proc}$；在接收整个数据包后，连接第一个和第二个链路的数据包交换机需要 $L/R_2$ 将数据包传输到第二个链路；数据包在第二个链路上以 $d_2/s_2$ 传播。类似地，我们可以找到第二个交换机和第三个链路引起的延迟：$L/R_3，d_{proc}$，和 $d_3/s_3$。

添加这些五个延迟得到 $d_{end-end} = L/R_1 + L/R_2 + L/R_3 + d_1/s_1 + d_2/s_2 + d_3/s_3 + d_{proc} + d_{proc}$。

我们简单地将值代入方程得到 $6 + 6 + 6 + 20 + 16 + 4 + 3 + 3 = 64 msec$。

### 问题11

因为位立即传输，数据包交换机不引入任何延迟；特别是，它不引入传输延迟。因此，$d_{end-end} = L/R + d_1/s_1 + d_2/s_2 + d_3/s_3$。

对于问题10中的值，我们得到 $6 + 20 + 16 + 4 = 46 msec$。

### 问题12

到达的数据包必须首先等待链路传输 $4.5 * 1,500 字节 = 6,750 字节或 54,000 位$。由于这些位以 2.5 Mbps 传输，排队延迟为 21.6 msec。一般来说，排队延迟为 $(nL + (L - x))/R。$

### 问题13

>a) 第一个传输数据包的排队延迟为0，第二个传输数据包为 L/R，一般来说，第n个传输数据包为 (n-1)L/R。因此，N个数据包的平均延迟为： $(L/R + 2L/R + \dots + (N-1)L/R)/N = L/(RN) \times (1 + 2 + \dots + (N-1)) = L/(RN) \times N(N-1)/2 = LN(N-1)/(2RN) = (N-1) \frac{L}{2R}$
>
>注意这里我们使用了众所周知的事实：$1 + 2 + \dots + N = N(N+1)/2。$
>
>b) 传输 N 个数据包需要 $NL/R$ 秒。因此，当每批 N 个数据包到达时，缓冲区为空。因此，所有批次中数据包的平均延迟是一个批次内的平均延迟，即 $(N-1)L/2R。$

### 问题14

a的单位是分组到达队列的平均速度，单位是分组/秒，pkt/s，R是传输速率，L是分组长度，单位是bit

>a) 传输延迟为 $L/R$。总延迟为 $\frac{IL}{R(1-I)}+\frac{L}{R}=\frac{L}{R(1-I)}$。
>
>b) 让 $x = L/R。总延迟 = \frac{x}{1-ax}$。当 x=0 时，总延迟=0；随着 x 增加，总延迟增加，当 x 接近 1/a 时接近无穷大。
>

### 问题15

$总延迟 = \frac{L/R}{1-I} = \frac{L/R}{1-aL/R} = \frac{1/\mu}{1-a/\mu} = \frac{1}{\mu - a}。$

### 问题16

系统中的总数据包数包括缓冲区中的那些和正在传输的数据包。所以，N=10+1。

因为 $N = a \times d$，所以 $(20+1) = a * (排队延迟 + 传输延迟)$。即 $21 = a * (0.01 + 1/100) = a * (0.01 + 0.01)$。因此，$a = 1050 packets/sec$。

### 问题17

$$
d_{end-end}=N(d_{proc}+d_{trans}+d_{prop})
$$

>a) 有 Q 个节点（源主机和 Q-1 个路由器）。让 $d_{proc}^q$ 表示第 q 个节点的处理延迟。让 $R^q$ 是第 q 个链路的传输速率，让 $d_{prop}^q = d^q / s^q$。让 $d_{trans}^q$ 是第 q 个链路的传播延迟。那么 $d_{end-end} = \sum_{q=1}^Q [d_{proc}^q + d_{trans}^q + d_{prop}^q]$。
>
>b) 让 $d_{queue}^q$ 表示节点 q 的平均排队延迟。那么 $d_{end-end} = \sum_{q=1}^Q [d_{proc}^q + d_{trans}^q + d_{prop}^q + d_{queue}^q]$。

### 问题18

在Linux上可以使用命令 traceroute www.targethost.com

在Windows命令提示符中使用 tracert www.targethost.com

在任何情况下，你都会得到三个延迟测量。对于这些测量，你可以计算均值和标准差。在一天的不同时间重复实验，并评论任何变化。

这里是一个示例解决方案：

>Traceroutes between San Diego Super Computer Center and [www.poly.edu](http://www.poly.edu)
>
>a) 每个三个小时的往返延迟平均值分别为71.18 ms、71.38 ms 和71.55 ms。标准差分别为0.075 ms、0.21 ms、0.05 ms。
>
>b) 在这个例子中，每个三个小时的路径都有12个路由器。不，路径在任何小时都没有变化。
>
>c) Traceroute数据包从源到目的地通过四个ISP网络。是的，在这个实验中，最大的延迟发生在相邻ISP之间的对等接口。
>
>Traceroutes from [www.stella-net.net](http://www.stella-net.net) (France) to [www.poly.edu](http://www.poly.edu) (USA)。↳
>
>d) 每个三个小时的往返延迟平均值分别为87.09 ms、86.35 ms 和86.48 ms。标准差分别为0.53 ms、0.18 ms、0.23 ms。在这个例子中，每个三个小时的路径都有11个路由器。不，路径在任何小时都没有变化。Traceroute数据包从源到目的地通过三个ISP网络。是的，在这个实验中，最大的延迟发生在相邻ISP之间的对等接口。

### 问题19

将发送 $n \times (n−1)$ 条消息。这个答案支持Metcalfe定律。

### 问题20

<img src="https://vip.123pan.cn/1843437589/yk6baz03t0n000d7w33hca7slqvtn3dxDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

$\text{Throughput} = \min \{ R_s, R_c, \frac{R}{M} \}$

### 问题21

<img src="https://vip.123pan.cn/1843437589/ymjew503t0n000d7w32ybp9k5vuoruhvDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

如果只使用一条路径，最大吞吐量由以下给出： $\max\{\min\{R_1^1, R_2^1, ..., R_M^1\}, \min\{R_1^2, R_2^2, ..., R_M^2\}, ..., \min\{R_1^M, R_2^M, ..., R_M^M\}\}$

如果使用所有路径，最大吞吐量由 $\sum_{k=1}^M \min\{R_1^k, R_2^k, \dots, R_M^k\}$ 给出。

### 问题22

<img src="https://vip.123pan.cn/1843437589/ymjew503t0n000d7w32ybp9k5vuoruhvDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

成功接收数据包的概率为：$ps = (1-p)^N。$

直到客户端成功接收数据包所需执行的传输次数是成功概率为ps的几何随机变量。因此，需要的平均传输次数为1/ps。然后，需要的平均重传次数为1/ps - 1。

### 问题23

<img src="https://vip.123pan.cn/1843437589/ymjew503t0n000d7w32ybp9k5vuoruhvDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

让我们称第一个数据包为A，第二个数据包为B。

>a) 如果瓶颈链路是第一个链路，则数据包B在第一个链路排队等待数据包A的传输。所以目的地的数据包间隔时间为 $L/R_s$。
>
>b) 如果第二个链路是瓶颈链路，并且两个数据包背靠背发送，则第二个数据包必须在第二个链路完成第一个数据包的传输之前到达第二个链路的输入队列。即， $L/Rs + L/Rs + d_{prop} < L/R_s + d_{prop} + L/R_c$
>
>上述不等式的左侧表示第二个数据包到达第二个链路输入队列所需的时间（第二个链路尚未开始传输第二个数据包）。右侧表示第一个数据包完成其传输到第二个链路所需的时间。
>
>如果我们晚T秒发送第二个数据包，我们将确保如果有： $L/R_s + L/R_s + d_{prop} + T >= L/R_s + d_{prop} + L/R_c$ 则第二个数据包在第二个链路没有排队延迟。因此，T的最小值为 $L/R_c - L/R_s$。

### 问题24

50太字节 = $50 * 10^{12} * 8$ 位。所以，如果使用专用链路，需要 $50 * 10^{12} * 8 / (100 * 10^6) = 4000000 秒 = 46 天$。但使用FedEx隔夜交付，你可以保证数据在一天内到达，而且成本应该不到100美元。

### 问题25

>a) 400,000 位 
>
>b) 400,000 位 
>
>c) 链路的带宽延迟积是链路中可以存在的最大位数。 
>
>d) 位的宽度 = 链路长度 / 带宽延迟积，所以1位长125米，比足球场长。 
>
>e) s/R

### 问题26

s/R = 20000 km，则 $R = s/20000 km = 2.5*10^8 / (2*10^7) = 12.5 bps$

### 问题27

>a) 40,000,000 位 
>
>b) 400,000 位，这是因为链路中任何给定时间的最大位数 = min(带宽延迟积, 数据包大小) = 400,000 位。 
>
>c) 0.5 米

### 问题28

>a) $t_{trans} + t_{prop} = 400 msec + 80 msec = 480 msec$。 
>
>b) $20 * (t_{trans} + 2 t_{prop}) = 20*(20 msec + 80 msec) = 2 sec$。 
>
>c) 分解文件需要更长时间传输，因为每个数据包及其对应的确认包添加了自己的传播延迟。

### 问题29

回想地球同步卫星距离地球表面36,000公里。

> a) 150 msec 
>
>b) 1,500,000 位 
>
>c) 600,000,000 位

### 问题30

<img src="https://vip.123pan.cn/1843437589/ymjew503t0n000d7w32ybpef29uylh3gDIYxDwFwAwJ1BGxwBdDP.png" style="zoom:50%;" />

假设乘客及其行李对应于到达协议栈顶部的数据单元。当乘客办理登机手续时，他的行李被检查，并在行李和票上附加标签。这是图1.22中行李层添加的附加信息，允许行李层实现发送端分离乘客和行李的服务，然后在目的地端重新结合。当乘客通过安检时，通常会在他的票上添加额外的印章，表明乘客已经通过了安检。此信息用于确保（例如，通过后续检查安全信息）人员的安全转移。

### 问题31

>a) 从源主机到第一个分组交换机发送消息的时间 = $\frac{8\times10^6}{2 \times 10^6} = 4 sec$。使用存储转发交换，从源主机到目的地主机移动消息的总时间 = $4 sec × 3 hops = 12 sec。$
>
>b) 从源主机到第一个分组交换机发送第一个数据包的时间 = $\frac{1 \times 10^4}{2 \times 10^6} = 5 msec$。第二个数据包到达第一个交换机的时间 = 第一个数据包到达第二个交换机的时间 = $2 × 5 msec = 10 msec。$
>
>c) 第一个数据包到达目的地主机的时间 = $5 msec × 3 hops = 15 msec$。在此之后，每5 msec接收一个数据包；因此，最后一个（第800个）数据包接收的时间 = $15 msec + (800 - 1) × 5 msec = 15 msec + 799 × 5 msec = 4010 msec$。可以看出，使用消息分段的延迟显著小于（几乎是1/3）。
>
>d) i. 没有消息分段，如果不容忍位错误，如果有一个单个位错误，整个消息必须重传（而不是单个数据包）。 ii. 没有消息分段，巨大的数据包（包含高清视频，例如）被发送到网络中。路由器必须容纳这些巨大的数据包。较小的数据包必须在巨大的数据包后面排队，并遭受不公平的延迟。
>
>e) i. 数据包必须在目的地按顺序放置。 ii. 消息分段导致许多较小的数据包。由于头部大小通常对于所有数据包无论大小都相同，使用消息分段，总头部字节量更多。

### 问题32

是的，动画中的延迟对应于问题31中的延迟。传播延迟对分组交换和消息交换的整体端到端延迟影响相同。

### 问题33

有 F/S 个数据包。每个数据包是大小是 S+80 位头部。最后一个数据包到达第一个路由器的时间是 $\frac{S+80}{R} \times \frac{F}{S} sec$。此时，第一个 F/S-2 个数据包在目的地，F/S-1 个数据包在第二个路由器中。最后一个数据包必须由第一个路由器和第二个路由器传输，每次传输需要 $\frac{S+80}{R}$ sec。因此，发送整个文件的$delay=\frac{S+80}{R} \times(2 + \frac{F}{S})。$

求导计算最小值，$\frac{d}{dS}delay = 0 => S = \sqrt{40 F}。$

### 问题34

电路交换电话网络和互联网通过“网关”连接在一起。当Skype用户（连接到互联网）呼叫普通电话时，在电路交换网络上在网关和电话用户之间建立电路。Skype用户的声音通过互联网以数据包形式发送到网关。在网关处，语音信号被重建，然后通过电路发送。在另一个方向，语音信号通过电路交换网络发送到网关。网关将语音信号打包并将语音数据包发送给Skype用户。